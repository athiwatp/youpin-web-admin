"use strict";riot.tag2("dashboard-new-issue-list",'<div class="new-issue-list"> <h1 class="page-title">New issue this week</h1> <ul> <li class="item" each="{data}"><img riot-src="{photos[0]}"><span><b>{detail} </br></b>{created_time} / {status} / {assigned_department.name} / {level}</span></li> </ul> </div>',"","",function(e){var s=this;s.data=[],api.getNewIssues(function(e){s.data=_.map(e.data,function(e){return e.created_time=moment(e.created_time).fromNow(),e}),s.update()})}),riot.tag2("dashboard-recent-activity",'<div class="recent-activity"><b>Recent Activity</b> <ul> <li class="activity" each="{data}"><span><b>{description} </br></b>{timestamp}</span></li> </ul> </div>',"","",function(e){var s=this;s.data=[],api.getRecentActivities(function(e){s.data=_.map(e,function(e){return e.timestamp=moment(e.timestamp).fromNow(),e}),s.update()})}),riot.tag2("dashboard-table-summary",'<h1 class="page-title">Overview</h1> <ul class="duration-selector"> <li class="{highlight: activeSelector == i}" each="{dur, i in durationSelectors}" onclick="{selectDuration(i)}" title="{dur.start}-today"> <div>{dur.name}</div> </li> </ul> <table class="summary"> <tr> <th class="team">Team</th> <th class="assigned">Assigned</th> <th class="processing">Processing</th> <th class="resolved">Resolved</th> <th class="rejected">Rejected</th> <th class="performance">Performance Index</th> </tr> <tr class="row {hide: shouldHideRow(department._id)}" each="{data}"> <td class="team">{department.name} {}</td> <td class="numeric-col">{assigned}</td> <td class="numeric-col">{processing}</td> <td class="numeric-col">{resolved}</td> <td class="numeric-col">{rejected}</td> <td class="performance {positive: performance &gt; 0, negative: performance &lt; 0}">{performance}</td> </tr> </table>',"","",function(e){function s(e,s,a){return moment().isoWeekday(1).startOf(e).add(a,s).format(t)}var a=this,t="YYYY-MM-DD",i=moment().format(t);a.activeSelector=0,this.durationSelectors=[{name:"week",start:s("week","day",1)},{name:"1 months",start:s("month","month",0)},{name:"2 months",start:s("month","month",-1)},{name:"6 months",start:s("month","month",-5)}],this.selectDuration=function(e){return function(){a.activeSelector=e;var s=a.durationSelectors[e].start;api.getSummary(user.organization,s,i,function(e){var s=e.data[0].by_department;s=_.keyBy(s,"department.name");for(var t=1;t<e.data.length;t++)_.each(e.data[t].by_department,function(e){_.each(["resolved","processing","assigned"],function(a){s[e.department.name][a]+=e[a]})});a.data=_.map(s,function(e){return e.performance=e.processing+e.resolved-e.assigned,e}),a.update()})}},this.selectDuration(0)(),this.shouldHideRow=function(e){return"organization_admin"!=user.role&&user.department!=e}}),riot.tag2("image-slider",'<div class="slider-list"> <yield></yield> </div>',"","",function(e){var s=this;s.item=e.item||"div",s.image="false"!==e.image,s.viewer="true"===e.viewer,s.arrows=!("false"===e.arrows),s.dots="true"===e.dots,s.autoplay=!("false"===e.autoplay),s.autoplay_speed=+(e.autoplaySpeed||12e3),s.fade=!("false"===e.fade),s.extendClass=[],s.extendClass=s.extendClass.join(" "),s.on("mount",function(){s.$slider=$(s.root).find(".slider-list"),s.$slider.children().show(),s.$slider.on("init reinit",function(e){s.image&&$(this).find(".slider-item").each(function(){var e=$(this),a=e.attr("data-src");a||(a=/url\(['"]?([^'"]*)['"]?\)/gi.exec(e.css("background-image"))[1]),e.empty(),"img"===s.item?e.append($("<img/>").addClass(s.extendClass).attr("data-src",a)):e.append($('<div class="image hide-on-error"/>').addClass(s.extendClass).attr("data-src",a).css("background-image","url('"+a+"')"))})}).on("setPosition",function(e,a){if(s.lazyload){var t=a.currentSlide;t=[0===t?a.$slides.length-1:t-1,t,t===a.$slides.length-1?0:t+1];_.compact($(a.$slides[t[0]]).add(a.$slides[t[1]]).add(a.$slides[t[2]]).find(".lazyload:not(.lazyloaded)").toArray())}}).slick({infinite:!0,speed:(s.fade,1200),fade:s.fade,autoplay:s.autoplay,autoplaySpeed:s.autoplay_speed,arrows:s.arrows,dots:s.dots,cssEase:"ease-in"}),s.viewer})}),riot.tag2("issue-page",'<h1 class="page-title">Issue <div class="bt-new-issue"><span>Create New Issue</span></div> </h1> <ul class="status-selector"> <li class="{active: name == selectedStatus}" each="{statuses}" onclick="{parent.select(name)}">{name}({issues})</li> </ul> <div class="menu-bar"> <div class="sorting">â–¾</div> <div class="list-or-map"><span class="active">List</span><span class="separator">/</span><span>Map</span></div> <div class="clearfix"></div> </div> <ul class="issue-list"> <li class="issue" each="{issues}"><img class="issue-img" src="http://lorempixel.com/150/150/city/"> <div class="issue-body"> <div class="issue-id"><b>ID</b>2340984509234</div> <div class="issue-desc">Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from 45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney College in Virginia, looked up one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and going through the cites of the word in classical literature, discovered the undoubtable source.</div> <div class="issue-category"> <div><b>Category</b></div><span class="bubble">walkway</span> </div> <div class="issue-location"> <div><b>Location</b></div><span class="bubble">Building A</span> </div> <div class="clearfix"></div> <div class="issue-tags"> <div><b>Tag</b></div><span class="bubble">Walkway</span><span class="bubble">Danger</span> </div> </div> <div class="issue-info"> <div><b>Status</b><span class="big-text">{selectedStatus}</span> <div class="clearfix"></div> </div> <div><b>Dept.</b><span class="big-text">Engineer</span> <div class="clearfix"></div> </div> <div><b>Thiti Luang</b></div> <div>Submitted on [date& time]</div> <div class="bt-manage-issue">Manage issue</div> </div> </li> </ul>',"","",function(e){var s=this;this.selectedStatus="pending",this.statuses=[{name:"pending",issues:4},{name:"assigned",issues:5},{name:"processing",issues:2},{name:"resolved",issues:1}],this.issues=_.range(0,this.statuses[0].issues),this.select=function(e){return function(){s.selectedStatus=e;var a=_.findIndex(s.statuses,{name:e});s.issues=_.range(0,s.statuses[a].issues),this.update()}}.bind(this)}),riot.tag2("preloader",'<div class="preloader-wrapper active {class}"> <div class="spinner-layer spinner-blue-only"> <div class="circle-clipper left"> <div class="circle"></div> </div> <div class="gap-patch"> <div class="circle"></div> </div> <div class="circle-clipper right"> <div class="circle"></div> </div> </div> </div>',"","",function(e){var s=this;s.class=e.class}),riot.tag2("search-box",'<a class="toggle-btn" href="#" onclick="{clickToggleSearch}"><i class="icon material-icons">search</i></a> <div class="search-box-wrapper" name="wrapper"> <form onsubmit="{submitSearch}"> <input class="flat" type="search" name="q" placeholder="{placeholder}" onblur="{clickToggleSearch}" tabindex="-1"> </form> </div>','search-box,[riot-tag="search-box"],[data-is="search-box"]{ display: inline-block; } search-box .toggle-btn,[riot-tag="search-box"] .toggle-btn,[data-is="search-box"] .toggle-btn{ display: inline-block; opacity: 1; transition: all 0.2s ease-out; } search-box .search-box-wrapper,[riot-tag="search-box"] .search-box-wrapper,[data-is="search-box"] .search-box-wrapper{ display: inline-block; width: 0; opacity: 0; padding-left: 0; padding-right: 0; transition: all 0.2s ease-out; } search-box.open .toggle-btn,[riot-tag="search-box"].open .toggle-btn,[data-is="search-box"].open .toggle-btn{ width: 0; opacity: 0; padding-left: 0; padding-right: 0; } search-box.open .search-box-wrapper,[riot-tag="search-box"].open .search-box-wrapper,[data-is="search-box"].open .search-box-wrapper{ width: 200px; opacity: 1; padding-left: 1rem; padding-right: 1rem; }','class="{open: open}"',function(e){var s=this;s.open=!1,s.path=e.path||"",s.placeholder=e.placeholder,s.on("updated",function(){s.open&&$(s.q).focus()}),s.clickToggleSearch=function(e){e.preventDefault(),s.open=!s.open,$("body")[s.open?"addClass":"removeClass"]("global-search-active")},s.submitSearch=function(e){e.preventDefault(),location.href=util.site_url(s.path,{q:s.q.value})}});